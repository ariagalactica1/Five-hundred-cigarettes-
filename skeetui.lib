-- LocalScript (place in StarterPlayerScripts or StarterGui)
-- "GAMESENSE" UI builder (client-side)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Helper: Color3 from hex (Roblox has Color3.fromHex in newer builds; fallback provided)
local function colorFromHex(hex)
    hex = hex:gsub("#","")
    if #hex == 3 then -- e.g. "fff" -> "ffffff"
        hex = hex:sub(1,1)..hex:sub(1,1)..hex:sub(2,2)..hex:sub(2,2)..hex:sub(3,3)..hex:sub(3,3)
    end
    local r = tonumber("0x"..hex:sub(1,2)) or 0
    local g = tonumber("0x"..hex:sub(3,4)) or 0
    local b = tonumber("0x"..hex:sub(5,6)) or 0
    return Color3.fromRGB(r,g,b)
end

-- Color palette (from your CSS)
local C = {
    bgMain = colorFromHex("#101110"),
    bgSidebar = colorFromHex("#1c1d1c"),
    bgActiveNav = colorFromHex("#2c2d2c"),
    bgControl = colorFromHex("#252525"),
    borderColor = colorFromHex("#3a3a3a"),
    accentGreen = colorFromHex("#9efd38"),
    textWhite = colorFromHex("#ffffff"),
    textLight = colorFromHex("#cccccc"),
    textMuted = colorFromHex("#6c6c6c"),
    headerBg = colorFromHex("#161716"),
    footerBorder = colorFromHex("#2a2a2a"),
}

-- Remove any old GUI instance (for convenient testing)
local existing = playerGui:FindFirstChild("GameSenseUI")
if existing then existing:Destroy() end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "GameSenseUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui
screenGui.DisplayOrder = 10

-- Root frames
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.Parent = screenGui
sidebar.AnchorPoint = Vector2.new(0,0)
sidebar.Position = UDim2.new(0,0,0,0)
sidebar.Size = UDim2.new(0,240,1,0)
sidebar.BackgroundColor3 = C.bgSidebar
sidebar.BorderSizePixel = 0

local mainContent = Instance.new("Frame")
mainContent.Name = "MainContent"
mainContent.Parent = screenGui
mainContent.AnchorPoint = Vector2.new(0,0)
mainContent.Position = UDim2.new(0,240,0,0)
mainContent.Size = UDim2.new(1,-240,1,0)
mainContent.BackgroundColor3 = C.bgMain
mainContent.BorderSizePixel = 0

-- Sidebar layout
local sidebarContainer = Instance.new("Frame")
sidebarContainer.Name = "SidebarContainer"
sidebarContainer.Parent = sidebar
sidebarContainer.AnchorPoint = Vector2.new(0,0)
sidebarContainer.Position = UDim2.new(0,0,0,0)
sidebarContainer.Size = UDim2.new(1,0,1,0)
sidebarContainer.BackgroundTransparency = 1

local sidebarList = Instance.new("UIListLayout")
sidebarList.Parent = sidebarContainer
sidebarList.SortOrder = Enum.SortOrder.LayoutOrder
sidebarList.Padding = UDim.new(0, 8)
sidebarList.HorizontalAlignment = Enum.HorizontalAlignment.Left

-- Header
local header = Instance.new("TextLabel")
header.Name = "SidebarHeader"
header.Parent = sidebarContainer
header.BackgroundTransparency = 1
header.Size = UDim2.new(1,0,0,64)
header.LayoutOrder = 1
header.Text = "GAMESENSE"
header.Font = Enum.Font.GothamBold
header.TextSize = 24
header.TextColor3 = C.textWhite
header.TextXAlignment = Enum.TextXAlignment.Left
header.TextYAlignment = Enum.TextYAlignment.Center
header.Padding = UDim.new(0,24) -- not a real property, simulate via position
header.Position = UDim2.new(0,0,0,0)
header.TextStrokeTransparency = 1
-- Use padding hack: put an invisible frame to create left padding for subsequent elements
local headerPad = Instance.new("Frame")
headerPad.Parent = sidebarContainer
headerPad.BackgroundTransparency = 1
headerPad.Size = UDim2.new(1,0,0,0)
headerPad.LayoutOrder = 2

-- Helper to create category labels
local function createCategory(text)
    local cat = Instance.new("TextLabel")
    cat.Name = "NavCategory"
    cat.Parent = sidebarContainer
    cat.BackgroundTransparency = 1
    cat.Size = UDim2.new(1,0,0,28)
    cat.LayoutOrder = sidebarList:GetChildren() and #sidebarList:GetChildren() + 1 or 0
    cat.Text = text:upper()
    cat.Font = Enum.Font.Gotham
    cat.TextSize = 11
    cat.TextColor3 = C.textMuted
    cat.TextXAlignment = Enum.TextXAlignment.Left
    cat.TextYAlignment = Enum.TextYAlignment.Center
    cat.TextScaled = false
    cat.Padding = UDim.new(0,24)
    return cat
end

-- Custom nav link builder
local navLinksFolder = Instance.new("Frame")
navLinksFolder.Parent = sidebarContainer
navLinksFolder.BackgroundTransparency = 1
navLinksFolder.Size = UDim2.new(1,0,0,0)
navLinksFolder.LayoutOrder = 10

local navListLayout = Instance.new("UIListLayout")
navListLayout.Parent = navLinksFolder
navListLayout.SortOrder = Enum.SortOrder.LayoutOrder
navListLayout.Padding = UDim.new(0,4)

local function createNavLink(text, isActive)
    local container = Instance.new("Frame")
    container.Name = "NavItem"
    container.Parent = navLinksFolder
    container.BackgroundTransparency = 1
    container.Size = UDim2.new(1,-20,0,40)
    container.LayoutOrder = 1

    local btn = Instance.new("TextButton")
    btn.Name = "NavButton"
    btn.Parent = container
    btn.AnchorPoint = Vector2.new(0,0)
    btn.Position = UDim2.new(0,10,0,0)
    btn.Size = UDim2.new(1,-10,1,0)
    btn.BackgroundColor3 = isActive and C.bgActiveNav or Color3.new(0,0,0)
    btn.BackgroundTransparency = isActive and 0 or 1
    btn.BorderSizePixel = 0
    btn.AutoButtonColor = true
    btn.Text = ""
    btn.LayoutOrder = 1

    -- Left indicator (active)
    local indicator = Instance.new("Frame")
    indicator.Name = "ActiveIndicator"
    indicator.Parent = btn
    indicator.Size = UDim2.new(0,3,0,20)
    indicator.Position = UDim2.new(0,0,0.5,-10)
    indicator.BackgroundColor3 = isActive and C.accentGreen or Color3.new(0,0,0)
    indicator.Visible = isActive

    -- Icon placeholder (use a small TextLabel that you can replace with ImageLabel)
    local icon = Instance.new("TextLabel")
    icon.Name = "NavIcon"
    icon.Parent = btn
    icon.Position = UDim2.new(0,8,0,0)
    icon.Size = UDim2.new(0,24,1,0)
    icon.BackgroundTransparency = 1
    icon.Text = "â—‰" -- placeholder icon; replace with ImageLabel using asset
    icon.Font = Enum.Font.Gotham
    icon.TextSize = 16
    icon.TextColor3 = isActive and C.textWhite or C.accentGreen
    icon.TextXAlignment = Enum.TextXAlignment.Center
    icon.TextYAlignment = Enum.TextYAlignment.Center

    local label = Instance.new("TextLabel")
    label.Name = "NavLabel"
    label.Parent = btn
    label.Position = UDim2.new(0,44,0,0)
    label.Size = UDim2.new(1,-44,1,0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.Font = Enum.Font.GothamSemibold
    label.TextSize = 14
    label.TextColor3 = isActive and C.textWhite or C.textLight
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center

    -- Hover effect
    btn.MouseEnter:Connect(function()
        if not indicator.Visible then
            btn.BackgroundTransparency = 0
            btn.BackgroundColor3 = C.bgActiveNav
        end
    end)
    btn.MouseLeave:Connect(function()
        if not indicator.Visible then
            btn.BackgroundTransparency = 1
        end
    end)

    -- Clicking sets active state
    btn.MouseButton1Click:Connect(function()
        -- clear all siblings
        for _,v in pairs(navLinksFolder:GetChildren()) do
            local b = v:FindFirstChild("NavButton")
            if b then
                local ind = b:FindFirstChild("ActiveIndicator")
                if ind then ind.Visible = false end
                b.BackgroundTransparency = 1
                local navLabel = b:FindFirstChild("NavLabel")
                local navIcon = b:FindFirstChild("NavIcon")
                if navLabel then navLabel.TextColor3 = C.textLight end
                if navIcon then navIcon.TextColor3 = C.accentGreen end
            end
        end
        -- set this active
        local ind = btn:FindFirstChild("ActiveIndicator")
        if ind then ind.Visible = true end
        btn.BackgroundTransparency = 0
        btn.BackgroundColor3 = C.bgActiveNav
        label.TextColor3 = C.textWhite
        icon.TextColor3 = C.textWhite
    end)

    return container
end

-- Build nav sections (copying your HTML)
createCategory("Aimbot")
createNavLink("RageBot", false)
createNavLink("Anti Aim", true)
createNavLink("Legitbot", false)

createCategory("Visuals")
createNavLink("Players", false)
createNavLink("Weapon", false)
createNavLink("Grenades", false)
createNavLink("Bomb", false)
createNavLink("World", false)
createNavLink("View", false)

createCategory("Miscellaneous")
createNavLink("Main", false)
createNavLink("Inventory", false)
createNavLink("Lua", false)
createNavLink("Configs", false)

-- Footer (profile)
local footer = Instance.new("Frame")
footer.Name = "SidebarFooter"
footer.Parent = sidebarContainer
footer.BackgroundTransparency = 1
footer.Size = UDim2.new(1,0,0,64)
footer.LayoutOrder = 999
footer.Position = UDim2.new(0,0,1,-80)

local footerLine = Instance.new("Frame")
footerLine.Parent = footer
footerLine.Size = UDim2.new(1,0,0,1)
footerLine.Position = UDim2.new(0,0,0,0)
footerLine.BackgroundColor3 = C.footerBorder
footerLine.BorderSizePixel = 0

local profileFrame = Instance.new("Frame")
profileFrame.Parent = footer
profileFrame.Size = UDim2.new(1,0,1, -1)
profileFrame.Position = UDim2.new(0,0,0,1)
profileFrame.BackgroundTransparency = 1

local avatar = Instance.new("ImageLabel")
avatar.Parent = profileFrame
avatar.Size = UDim2.new(0,40,0,40)
avatar.Position = UDim2.new(0,12,0,12)
avatar.BackgroundTransparency = 0
avatar.Image = "rbxthumb://type=AvatarHeadShot&id="..tostring(player.UserId).."&w=48&h=48"
avatar.BorderSizePixel = 0
local avatarCorner = Instance.new("UICorner", avatar)
avatarCorner.CornerRadius = UDim.new(1,0)

local profileInfo = Instance.new("Frame")
profileInfo.Parent = profileFrame
profileInfo.BackgroundTransparency = 1
profileInfo.Position = UDim2.new(0,64,0,12)
profileInfo.Size = UDim2.new(1,-64,0,40)

local nameLabel = Instance.new("TextLabel")
nameLabel.Parent = profileInfo
nameLabel.Size = UDim2.new(1,0,0,20)
nameLabel.Position = UDim2.new(0,0,0,0)
nameLabel.BackgroundTransparency = 1
nameLabel.Text = player.Name
nameLabel.Font = Enum.Font.GothamSemibold
nameLabel.TextSize = 14
nameLabel.TextColor3 = C.textWhite
nameLabel.TextXAlignment = Enum.TextXAlignment.Left

local statusLabel = Instance.new("TextLabel")
statusLabel.Parent = profileInfo
statusLabel.Size = UDim2.new(1,0,0,16)
statusLabel.Position = UDim2.new(0,0,0,20)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "TIE: 27.08 24:00"
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 12
statusLabel.TextColor3 = C.textMuted
statusLabel.TextXAlignment = Enum.TextXAlignment.Left

-- MAIN CONTENT HEADER
local mainHeader = Instance.new("Frame")
mainHeader.Name = "MainHeader"
mainHeader.Parent = mainContent
mainHeader.AnchorPoint = Vector2.new(0,0)
mainHeader.Position = UDim2.new(0,0,0,0)
mainHeader.Size = UDim2.new(1,0,0,56)
mainHeader.BackgroundColor3 = C.headerBg
mainHeader.BorderSizePixel = 0

local saveButton = Instance.new("TextButton")
saveButton.Parent = mainHeader
saveButton.Size = UDim2.new(0,110,0,36)
saveButton.Position = UDim2.new(0,16,0,10)
saveButton.BackgroundColor3 = C.bgControl
saveButton.BorderColor3 = C.borderColor
saveButton.Text = "Save"
saveButton.Font = Enum.Font.Gotham
saveButton.TextSize = 14
saveButton.TextColor3 = C.textLight

local headerActions = Instance.new("Frame")
headerActions.Parent = mainHeader
headerActions.BackgroundTransparency = 1
headerActions.Size = UDim2.new(0,160,1,0)
headerActions.Position = UDim2.new(1,-176,0,0)

local headerLayout = Instance.new("UIListLayout")
headerLayout.Parent = headerActions
headerLayout.FillDirection = Enum.FillDirection.Horizontal
headerLayout.Padding = UDim.new(0,12)
headerLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
headerLayout.SortOrder = Enum.SortOrder.LayoutOrder

local function makeHeaderIcon(symbol, color)
    local lbl = Instance.new("TextLabel")
    lbl.Parent = headerActions
    lbl.BackgroundTransparency = 1
    lbl.Size = UDim2.new(0,24,0,24)
    lbl.Text = symbol -- placeholder
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 18
    lbl.TextColor3 = color or C.textLight
    lbl.TextXAlignment = Enum.TextXAlignment.Center
    lbl.TextYAlignment = Enum.TextYAlignment.Center
    return lbl
end

makeHeaderIcon("ðŸ’¬")
makeHeaderIcon("âš™ï¸", C.accentGreen)
makeHeaderIcon("âš™ï¸")

-- CONTENT BODY (scrollable)
local contentBody = Instance.new("ScrollingFrame")
contentBody.Parent = mainContent
contentBody.Name = "ContentBody"
contentBody.Position = UDim2.new(0,0,0,56)
contentBody.Size = UDim2.new(1,0,1,-56)
contentBody.CanvasSize = UDim2.new(0,0,0,0)
contentBody.ScrollBarThickness = 8
contentBody.BackgroundTransparency = 1
contentBody.BorderSizePixel = 0
contentBody.AutomaticCanvasSize = Enum.AutomaticSize.Y

local contentLayout = Instance.new("UIGridLayout")
contentLayout.Parent = contentBody
contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
contentLayout.CellPadding = UDim2.new(0,24,0,24)
contentLayout.CellSize = UDim2.new(0, 320, 0, 340)
contentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Utilities: UICorner and UIStroke generator
local function addUICorner(inst, radius)
    local c = Instance.new("UICorner")
    c.CornerRadius = radius or UDim.new(0,6)
    c.Parent = inst
    return c
end
local function addUIStroke(inst, color, thickness)
    local s = Instance.new("UIStroke")
    s.Parent = inst
    s.Color = color or C.borderColor
    s.Thickness = thickness or 1
    return s
end

-- Control element factories
local function createSettingsCard(title)
    local card = Instance.new("Frame")
    card.Name = "SettingsCard"
    card.Size = UDim2.new(0,320,0,340)
    card.BackgroundColor3 = C.bgControl
    card.BorderSizePixel = 0
    addUICorner(card, UDim.new(0,8))
    card.Parent = contentBody

    local inner = Instance.new("Frame")
    inner.Parent = card
    inner.Size = UDim2.new(1,-20,1,-20)
    inner.Position = UDim2.new(0,10,0,10)
    inner.BackgroundTransparency = 1

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Parent = inner
    titleLabel.Size = UDim2.new(1,0,0,24)
    titleLabel.Position = UDim2.new(0,0,0,0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title:upper()
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 14
    titleLabel.TextColor3 = C.textWhite
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left

    local contentFrame = Instance.new("Frame")
    contentFrame.Parent = inner
    contentFrame.BackgroundTransparency = 1
    contentFrame.Size = UDim2.new(1,0,1, -28)
    contentFrame.Position = UDim2.new(0,0,0,32)

    return card, contentFrame
end

-- Toggle switch factory
local function createToggleLine(parent, labelText, default)
    local line = Instance.new("Frame")
    line.Parent = parent
    line.Size = UDim2.new(1,0,0,34)
    line.BackgroundTransparency = 1

    local label = Instance.new("TextLabel")
    label.Parent = line
    label.Size = UDim2.new(0.6,0,1,0)
    label.Position = UDim2.new(0,0,0,0)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextColor3 = C.textLight
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center

    local switch = Instance.new("TextButton")
    switch.Parent = line
    switch.AnchorPoint = Vector2.new(1,0)
    switch.Size = UDim2.new(0,38,0,22)
    switch.Position = UDim2.new(1, -2, 0.5, -11)
    switch.Text = ""
    switch.BackgroundColor3 = C.bgControl
    switch.BorderColor3 = C.borderColor
    local corner = addUICorner(switch, UDim.new(0,22))
    addUIStroke(switch, C.borderColor, 1)

    local knob = Instance.new("Frame")
    knob.Parent = switch
    knob.Name = "Knob"
    knob.Size = UDim2.new(0,16,0,16)
    knob.Position = default and UDim2.new(0,20,0,2) or UDim2.new(0,2,0,2)
    knob.BackgroundColor3 = default and C.bgSidebar or Color3.fromRGB(136,136,136)
    addUICorner(knob, UDim.new(1,0))

    -- Toggle behaviour
    local toggled = default or false
    switch.MouseButton1Click:Connect(function()
        toggled = not toggled
        if toggled then
            knob:TweenPosition(UDim2.new(0,20,0,2), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.12, true)
            knob.BackgroundColor3 = C.bgSidebar
            switch.BackgroundColor3 = C.accentGreen
            switch.BorderColor3 = C.accentGreen
        else
            knob:TweenPosition(UDim2.new(0,2,0,2), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.12, true)
            knob.BackgroundColor3 = Color3.fromRGB(136,136,136)
            switch.BackgroundColor3 = C.bgControl
            switch.BorderColor3 = C.borderColor
        end
    end)

    return line, function() return toggled end
end

-- Dropdown factory (simple)
local function createDropdownLine(parent, labelText, options, defaultIndex)
    local line = Instance.new("Frame")
    line.Parent = parent
    line.Size = UDim2.new(1,0,0,36)
    line.BackgroundTransparency = 1

    local label = Instance.new("TextLabel")
    label.Parent = line
    label.Size = UDim2.new(0.55,0,1,0)
    label.Position = UDim2.new(0,0,0,0)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextColor3 = C.textLight
    label.TextXAlignment = Enum.TextXAlignment.Left

    local wrapper = Instance.new("Frame")
    wrapper.Parent = line
    wrapper.AnchorPoint = Vector2.new(1,0)
    wrapper.Size = UDim2.new(0,180,1,0)
    wrapper.Position = UDim2.new(1, -6, 0, 0)
    wrapper.BackgroundColor3 = C.bgControl
    wrapper.BorderColor3 = C.borderColor
    addUICorner(wrapper, UDim.new(0,6))

    local selected = Instance.new("TextButton")
    selected.Parent = wrapper
    selected.Size = UDim2.new(1,0,1,0)
    selected.BackgroundTransparency = 1
    selected.Text = options[defaultIndex] or options[1] or ""
    selected.TextColor3 = C.textLight
    selected.Font = Enum.Font.Gotham
    selected.TextSize = 14
    selected.AutoButtonColor = true

    local dropdown = Instance.new("Frame")
    dropdown.Parent = wrapper
    dropdown.Size = UDim2.new(1,0,0,#options*28)
    dropdown.Position = UDim2.new(0,0,1,4)
    dropdown.BackgroundColor3 = C.bgControl
    addUICorner(dropdown, UDim.new(0,6))
    dropdown.Visible = false
    dropdown.ClipsDescendants = true

    local ddLayout = Instance.new("UIListLayout")
    ddLayout.Parent = dropdown
    ddLayout.SortOrder = Enum.SortOrder.LayoutOrder

    for i,opt in ipairs(options) do
        local btn = Instance.new("TextButton")
        btn.Parent = dropdown
        btn.Size = UDim2.new(1,0,0,28)
        btn.BackgroundTransparency = 1
        btn.Text = opt
        btn.Font = Enum.Font.Gotham
        btn.TextSize = 14
        btn.TextColor3 = C.textLight
        btn.AutoButtonColor = true
        btn.MouseButton1Click:Connect(function()
            selected.Text = opt
            dropdown.Visible = false
        end)
    end

    selected.MouseButton1Click:Connect(function()
        dropdown.Visible = not dropdown.Visible
    end)

    return line, function() return selected.Text end
end

-- Slider factory (click & drag)
local function createSliderLine(parent, labelText, min, max, initial)
    min = min or 0
    max = max or 100
    initial = initial or 0

    local line = Instance.new("Frame")
    line.Parent = parent
    line.Size = UDim2.new(1,0,0,56)
    line.BackgroundTransparency = 1

    local labelRow = Instance.new("Frame")
    labelRow.Parent = line
    labelRow.Size = UDim2.new(1,0,0,20)
    labelRow.BackgroundTransparency = 1

    local label = Instance.new("TextLabel")
    label.Parent = labelRow
    label.Size = UDim2.new(0.6,0,1,0)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextColor3 = C.textLight
    label.TextXAlignment = Enum.TextXAlignment.Left

    local valueLabel = Instance.new("TextLabel")
    valueLabel.Parent = labelRow
    valueLabel.Size = UDim2.new(0.4,-4,1,0)
    valueLabel.Position = UDim2.new(0.6,4,0,0)
    valueLabel.BackgroundTransparency = 1
    valueLabel.Text = tostring(initial)
    valueLabel.Font = Enum.Font.Gotham
    valueLabel.TextSize = 14
    valueLabel.TextColor3 = C.textMuted
    valueLabel.TextXAlignment = Enum.TextXAlignment.Right

    local sliderContainer = Instance.new("Frame")
    sliderContainer.Parent = line
    sliderContainer.Size = UDim2.new(1,0,0,20)
    sliderContainer.Position = UDim2.new(0,0,0,28)
    sliderContainer.BackgroundTransparency = 1

    local bar = Instance.new("Frame")
    bar.Parent = sliderContainer
    bar.Size = UDim2.new(1,-80,0,6)
    bar.Position = UDim2.new(0,40,0,7)
    bar.BackgroundColor3 = C.bgControl
    addUICorner(bar, UDim.new(0,6))

    local fill = Instance.new("Frame")
    fill.Parent = bar
    fill.Size = UDim2.new(initial/(max-min),0,1,0)
    fill.BackgroundColor3 = C.accentGreen
    addUICorner(fill, UDim.new(0,6))

    local thumb = Instance.new("ImageButton")
    thumb.Parent = sliderContainer
    thumb.Size = UDim2.new(0,16,0,16)
    -- Set initial X based on initial
    local function updateThumbByValue(val)
        local frac = (val - min) / (max - min)
        fill.Size = UDim2.new(math.clamp(frac,0,1),0,1,0)
        local barAbs = bar.AbsolutePosition
        local barW = bar.AbsoluteSize.X
        local xOffset = math.clamp(frac * barW, 0, barW)
        thumb.Position = UDim2.new(0, bar.Position.X.Offset + xOffset + 40, 0, 2)
    end

    -- Visual thumb (use ImageButton because it's interactive)
    thumb.Position = UDim2.new(0, 40 + (initial/(max-min)) * (bar.AbsoluteSize.X or 200), 0, 2)
    thumb.BackgroundColor3 = C.accentGreen
    thumb.BorderSizePixel = 0
    thumb.AutoButtonColor = false
    addUICorner(thumb, UDim.new(1,0))
    thumb.Size = UDim2.new(0,16,0,16)

    -- Dragging logic
    local dragging = false
    local currentValue = initial
    local function setValueFromX(x)
        local barPos = bar.AbsolutePosition.X
        local barW = bar.AbsoluteSize.X
        local rel = (x - barPos)
        local frac = math.clamp(rel / barW, 0, 1)
        local val = math.floor(min + frac * (max - min) + 0.5)
        currentValue = val
        valueLabel.Text = tostring(val)
        fill.Size = UDim2.new(frac,0,1,0)
        -- position thumb precisely
        local newX = bar.Position.X.Offset + frac * barW + 40
        thumb.Position = UDim2.new(0, newX, 0, 2)
    end

    thumb.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)
    thumb.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    RunService.Heartbeat:Connect(function()
        if dragging then
            local mouse = player:GetMouse()
            setValueFromX(mouse.X)
        end
    end)

    -- Also allow clicking on bar to jump
    bar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local mouse = player:GetMouse()
            setValueFromX(mouse.X)
        end
    end)

    -- initial update (defer a tick in case AbsoluteSize not ready)
    delay(0.01, function()
        if bar.AbsoluteSize.X > 0 then
            updateThumbByValue(initial)
            valueLabel.Text = tostring(initial)
        end
    end)

    return line, function() return currentValue end
end

-- Compose the left-most column of cards (matching your HTML)
local cardAA, cardAAContent = createSettingsCard("Anti-aimbot angles")
cardAA.LayoutOrder = 1

-- Build content inside Anti-aim card
do
    -- Enabled toggle
    local tline, tget = createToggleLine(cardAAContent, "Enabled", true)
    tline.Parent = cardAAContent

    -- Pitch dropdown
    local dd1, dd1get = createDropdownLine(cardAAContent, "Pitch", {"Off"}, 1)
    dd1.Parent = cardAAContent

    -- Yaw base dropdown
    local dd2, dd2get = createDropdownLine(cardAAContent, "Yaw base", {"Local view"}, 1)
    dd2.Parent = cardAAContent

    -- Yaw slider
    local s1, s1get = createSliderLine(cardAAContent, "Yaw", 0, 100, 50)
    s1.Parent = cardAAContent

    -- Yaw jitter
    local s2, s2get = createSliderLine(cardAAContent, "Yaw jitter", 0, 100, 0)
    s2.Parent = cardAAContent

    -- Body yaw
    local s3, s3get = createSliderLine(cardAAContent, "Body yaw", 0, 100, 0)
    s3.Parent = cardAAContent

    -- Freestanding body yaw (toggle + slider)
    local fsLine = Instance.new("Frame")
    fsLine.Size = UDim2.new(1,0,0,56)
    fsLine.BackgroundTransparency = 1
    fsLine.Parent = cardAAContent

    local fsLabel = Instance.new("TextLabel")
    fsLabel.Parent = fsLine
    fsLabel.Size = UDim2.new(0.66,0,0,20)
    fsLabel.Position = UDim2.new(0,0,0,0)
    fsLabel.BackgroundTransparency = 1
    fsLabel.Text = "Freestanding body yaw"
    fsLabel.Font = Enum.Font.Gotham
    fsLabel.TextSize = 14
    fsLabel.TextColor3 = C.textLight
    fsLabel.TextXAlignment = Enum.TextXAlignment.Left

    local fsToggle = createToggleLine(fsLine, "", true) -- reuse toggle to render; returns line and getter, but we already put into fsLine
    -- Slider below:
    local fsSlider, fsGet = createSliderLine(cardAAContent, "Freestanding body yaw value", 0, 100, 60)
    fsSlider.Parent = cardAAContent

    -- Edge yaw and freestanding select
    local tEdge, edgeGet = createToggleLine(cardAAContent, "Edge yaw", false)
    tEdge.Parent = cardAAContent

    local dd3, dd3get = createDropdownLine(cardAAContent, "Freestanding", {"-"}, 1)
    dd3.Parent = cardAAContent
end

-- Fake lag card (middle column)
local cardFL, cardFLContent = createSettingsCard("Fake lag")
cardFL.LayoutOrder = 2

do
    local tline, tget = createToggleLine(cardFLContent, "Enabled", true)
    tline.Parent = cardFLContent

    local dd, ddget = createDropdownLine(cardFLContent, "Amount", {"Dynamic"}, 1)
    dd.Parent = cardFLContent

    local sVar, sVarGet = createSliderLine(cardFLContent, "Variance", 0, 100, 0)
    sVar.Parent = cardFLContent

    local sLimit, sLimitGet = createSliderLine(cardFLContent, "Limit", 0, 100, 0)
    sLimit.Parent = cardFLContent
end

-- Other card (right column)
local cardOther, cardOtherContent = createSettingsCard("Other")
cardOther.LayoutOrder = 3

do
    local tline, tget = createToggleLine(cardOtherContent, "Slow motion", true)
    tline.Parent = cardOtherContent

    local dd1, dd1get = createDropdownLine(cardOtherContent, "Slow motion type", {"Favor high speed"}, 1)
    dd1.Parent = cardOtherContent

    local dd2, dd2get = createDropdownLine(cardOtherContent, "Leg movement", {"Off"}, 1)
    dd2.Parent = cardOtherContent

    local tshot, tshotGet = createToggleLine(cardOtherContent, "On shot anti-aim", false)
    tshot.Parent = cardOtherContent

    local fpeek, fpeekGet = createToggleLine(cardOtherContent, "Fake peek", false)
    fpeek.Parent = cardOtherContent
end

-- Refresh contentBody canvas size after children layout
local function refreshCanvas()
    local totalHeight = 0
    for _, child in pairs(contentBody:GetChildren()) do
        if child:IsA("Frame") and child.Visible then
            totalHeight = totalHeight + child.AbsoluteSize.Y + (contentLayout.CellPadding.Y.Offset or 24)
        end
    end
    contentBody.CanvasSize = UDim2.new(0,0,0,math.max(totalHeight, contentBody.AbsoluteSize.Y))
end

contentBody:GetPropertyChangedSignal("CanvasPosition"):Connect(function() end)
contentBody:GetPropertyChangedSignal("AbsoluteSize"):Connect(function() refreshCanvas() end)

-- initial refresh in case AbsoluteSize values require a tick
delay(0.03, function() refreshCanvas() end)

-- End result message (print)
print("GameSense UI created for player:", player.Name)
