--[[
  GameSense UI Replica (Client-Sided / LocalScript)
  -------------------------------------------------
  â€¢ Drop this script into StarterPlayer > StarterPlayerScripts (as a LocalScript)
  â€¢ This version focuses on a pixel-accurate **SIDEBAR** replica like your second screenshot:
      - Lime "GAMESENSE" header, pill-selected item, green dot indicator
      - Section headers (RageBot, Legitbot, Visuals, Miscellaneous)
      - Icon + label for each entry
      - Soft gradient glow along the left edge and glassy nav pills
      - Player card with avatar at the bottom-left
  â€¢ All assets rely on built-in primitives (no external models required).

  NOTE: Purely UI. No gameplay is wired.
]]

--// Services
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

--// Theme
local Theme = {
  bg           = Color3.fromRGB(16,16,16),
  panel        = Color3.fromRGB(22,22,22),
  panelAlt     = Color3.fromRGB(26,26,26),
  stroke       = Color3.fromRGB(35,35,35),
  accent       = Color3.fromRGB(120, 230, 80), -- gamesense green
  text         = Color3.fromRGB(230,230,230),
  textDim      = Color3.fromRGB(155,155,155),
  navWidth     = 210,
  topbarH      = 52,
}

--// Helpers
local function Create(className, props, children)
  local o = Instance.new(className)
  for k,v in pairs(props or {}) do o[k] = v end
  if children then for _,c in ipairs(children) do c.Parent = o end end
  return o
end
local function round(parent, r)
  Create("UICorner", {CornerRadius = UDim.new(0, r or 10), Parent = parent})
end
local function stroke(parent, c, t)
  Create("UIStroke", {Color = c or Theme.stroke, Thickness = t or 1, ApplyStrokeMode = Enum.ApplyStrokeMode.Border, Parent = parent})
end
local function pad(parent, l,t,r,b)
  Create("UIPadding", {PaddingLeft=UDim.new(0,l or 0), PaddingTop=UDim.new(0,t or 0), PaddingRight=UDim.new(0,r or 0), PaddingBottom=UDim.new(0,b or 0), Parent=parent})
end
local function list(parent, padding)
  return Create("UIListLayout", {Parent=parent, Padding = UDim.new(0, padding or 8), SortOrder = Enum.SortOrder.LayoutOrder})
end

--// Root GUI
local player = Players.LocalPlayer
local gui = Create("ScreenGui", {Name = "GameSenseReplica", ResetOnSpawn=false, IgnoreGuiInset=true, ZIndexBehavior=Enum.ZIndexBehavior.Sibling, Parent = player:WaitForChild("PlayerGui")})

-- Window
local window = Create("Frame", {Size=UDim2.new(0, 980, 0, 600), AnchorPoint=Vector2.new(0.5,0.5), Position=UDim2.new(0.5,0,0.5,0), BackgroundColor3=Theme.panel, BorderSizePixel=0, Parent=gui})
round(window, 12)
stroke(window, Theme.stroke, 1)

-- soft shadow
Create("ImageLabel", {Parent=window, BackgroundTransparency=1, Image="rbxassetid://5028857084", ScaleType=Enum.ScaleType.Slice, SliceCenter=Rect.new(24,24,276,276), ImageTransparency=0.55, Size=UDim2.new(1,40,1,40), Position=UDim2.new(0,-20,0,-10), ZIndex=0})

-- Header
local header = Create("Frame", {Parent=window, Size=UDim2.new(1,0,0,Theme.topbarH), BackgroundColor3=Theme.panelAlt, BorderSizePixel=0})
round(header, 12)
pad(header, 16,10,16,10)
local hl = list(header, 10); hl.FillDirection = Enum.FillDirection.Horizontal; hl.VerticalAlignment = Enum.VerticalAlignment.Center

Create("TextLabel", {Parent=header, Size=UDim2.new(0, 170, 1, -10), BackgroundTransparency=1, Text="GAMESENSE", TextColor3=Theme.accent, TextXAlignment=Enum.TextXAlignment.Left, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json", Enum.FontWeight.Medium), TextSize=22, LayoutOrder=1})

local spacer = Create("Frame", {Parent=header, BackgroundTransparency=1, Size=UDim2.new(1,-360,1,-10), LayoutOrder=2})

local saveBtn = Create("TextButton", {Parent=header, Text="Save", Size=UDim2.new(0,88,0,30), BackgroundColor3=Theme.accent, TextColor3=Theme.bg, AutoButtonColor=false, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json", Enum.FontWeight.Medium), TextSize=16, LayoutOrder=3, BorderSizePixel=0})
round(saveBtn, 10)

-- Sidebar
local sidebar = Create("Frame", {Parent=window, Position=UDim2.new(0,0,0,Theme.topbarH), Size=UDim2.new(0, Theme.navWidth, 1, -Theme.topbarH), BackgroundColor3=Theme.panel, BorderSizePixel=0})
pad(sidebar, 12,14,12,14)

-- left glow gradient
local glow = Create("ImageLabel", {Parent=sidebar, BackgroundTransparency=1, Image="rbxassetid://7131267197", ImageTransparency=0.8, ImageColor3=Theme.accent, Rotation=90, Size=UDim2.new(1.2,0,0,220), Position=UDim2.new(-0.1,0,0,-40), ZIndex=0})

local navScroll = Create("ScrollingFrame", {Parent=sidebar, Size=UDim2.new(1,0,1,-70), BackgroundTransparency=1, ScrollBarThickness=4, BorderSizePixel=0, CanvasSize=UDim2.new(0,0,0,0)})
local navLayout = list(navScroll, 6)

-- bottom player card
local bottomCard = Create("Frame", {Parent=sidebar, AnchorPoint=Vector2.new(0,1), Position=UDim2.new(0,0,1,0), Size=UDim2.new(1,0,0,56), BackgroundColor3=Theme.panelAlt, BorderSizePixel=0})
round(bottomCard, 10)
stroke(bottomCard, Theme.stroke, 1)
pad(bottomCard, 8,8,8,8)
local plLayout = list(bottomCard, 8); plLayout.FillDirection = Enum.FillDirection.Horizontal; plLayout.VerticalAlignment = Enum.VerticalAlignment.Center

local headImage = Create("ImageLabel", {Parent=bottomCard, Size=UDim2.new(0,40,0,40), BackgroundColor3=Color3.fromRGB(34,34,34)})
round(headImage, 20)
-- attempt fetching thumbnail at runtime
local success, content = pcall(function()
  return Players:GetUserThumbnailAsync(player.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
end)
if success then headImage.Image = content; headImage.BackgroundTransparency = 1 end

Create("TextLabel", {Parent=bottomCard, Size=UDim2.new(1,-52,1,0), BackgroundTransparency=1, Text=player.DisplayName, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=14, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json")})

-- NAV DATA (with icons)
-- We use unicode emoji for a lightweight, dependency-free icon set.
local navSpec = {
  { kind="section", label="RageBot" },
  { kind="item",   label="Anti Aim",     icon="â—‰" },
  { kind="section", label="Legitbot" },
  { kind="section", label="Visuals" },
  { kind="item",   label="Players",     icon="ðŸ‘¤" },
  { kind="item",   label="Weapon",      icon="ðŸ”«" },
  { kind="item",   label="Grenades",    icon="ðŸ§¨" },
  { kind="item",   label="World",       icon="ðŸŒ" },
  { kind="item",   label="View",        icon="ðŸ‘" },
  { kind="item",   label="Bomb",        icon="ðŸ’£" },
  { kind="section", label="Miscellaneous" },
  { kind="item",   label="Main",        icon="ðŸ " },
  { kind="item",   label="Inventory",   icon="ðŸŽ’" },
  { kind="item",   label="Lua",         icon="{ }" },
  { kind="item",   label="Configs",     icon="âš™" },
}

-- page registry
local pages = {}
local current = nil

local function makeSection(text)
  local lbl = Create("TextLabel", {Parent=navScroll, Size=UDim2.new(1,0,0,18), BackgroundTransparency=1, Text=text, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.textDim, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json", Enum.FontWeight.Medium), TextSize=13})
  lbl.LayoutOrder = 0
end

local function makePill(text, icon)
  local btn = Create("TextButton", {Parent=navScroll, Size=UDim2.new(1,0,0,34), BackgroundColor3=Theme.panelAlt, AutoButtonColor=false, BorderSizePixel=0, Text="", ZIndex=2})
  round(btn, 10)
  stroke(btn, Theme.stroke, 1)
  pad(btn, 10,0,10,0)
  local row = list(btn, 8); row.FillDirection = Enum.FillDirection.Horizontal; row.VerticalAlignment = Enum.VerticalAlignment.Center

  local dot = Create("Frame", {Parent=btn, Size=UDim2.new(0,12,0,12), BackgroundColor3=Theme.accent})
  round(dot, 6)
  dot.Visible = false -- only for selected item

  local iconLbl = Create("TextLabel", {Parent=btn, BackgroundTransparency=1, Text=icon or "â€¢", TextColor3=Theme.accent, TextSize=16, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), Size=UDim2.new(0,18,1,0)})

  local txt = Create("TextLabel", {Parent=btn, BackgroundTransparency=1, Text=text, TextColor3=Theme.text, TextXAlignment=Enum.TextXAlignment.Left, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), TextSize=15, Size=UDim2.new(1,-36,1,0)})

  local function setSelected(sel)
    dot.Visible = sel
    TweenService:Create(btn, TweenInfo.new(0.12, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {BackgroundColor3 = sel and Color3.fromRGB(44,44,44) or Theme.panelAlt}):Play()
    iconLbl.TextColor3 = sel and Theme.accent or Theme.accent
    txt.TextColor3 = sel and Theme.text or Theme.text
  end

  btn.MouseEnter:Connect(function()
    if current ~= text then TweenService:Create(btn, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(36,36,36)}):Play() end
  end)
  btn.MouseLeave:Connect(function()
    if current ~= text then TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = Theme.panelAlt}):Play() end
  end)

  btn.MouseButton1Click:Connect(function()
    -- clear others
    for _, child in ipairs(navScroll:GetChildren()) do
      if child:IsA("TextButton") and child ~= btn then
        child:SetAttribute("selected", false)
        child:GetChildren()[1].Visible = false -- dot
        TweenService:Create(child, TweenInfo.new(0.15), {BackgroundColor3 = Theme.panelAlt}):Play()
      end
    end
    current = text
    setSelected(true)
    for name, page in pairs(pages) do
      page.Visible = (name == text)
    end
  end)

  return btn
end

-- Build nav
for _, def in ipairs(navSpec) do
  if def.kind == "section" then
    makeSection(def.label)
  else
    local pill = makePill(def.label, def.icon)
    pill.Name = "nav_"..def.label
  end
end

-- compute CanvasSize
local function recomputeCanvas()
  local h = 0
  for _,c in ipairs(navScroll:GetChildren()) do
    if c:IsA("GuiObject") then h += c.AbsoluteSize.Y + 6 end
  end
  navScroll.CanvasSize = UDim2.new(0,0,0,math.max(h, navScroll.AbsoluteSize.Y))
end
navScroll.ChildAdded:Connect(recomputeCanvas)
navScroll.ChildRemoved:Connect(recomputeCanvas)
UIS.InputEnded:Connect(function() task.defer(recomputeCanvas) end)
recomputeCanvas()

-- Content area
local content = Create("Frame", {Parent=window, Position=UDim2.new(0, Theme.navWidth, 0, Theme.topbarH), Size=UDim2.new(1, -Theme.navWidth, 1, -Theme.topbarH), BackgroundTransparency=1})

-- Utility components (Switch, Slider, Dropdown) kept from previous version
local Components = {}
function Components.Switch(parent, labelText, default, onChanged)
  local container = Create("Frame", {Parent=parent, BackgroundTransparency=1, Size=UDim2.new(1,0,0,36)})
  local row = Create("UIListLayout", {Parent=container, Padding=UDim.new(0,8), FillDirection=Enum.FillDirection.Horizontal, VerticalAlignment=Enum.VerticalAlignment.Center})
  local lbl = Create("TextLabel", {Parent=container, BackgroundTransparency=1, Text=labelText, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=14, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), Size=UDim2.new(1,-60,1,0)})
  local knob = Create("Frame", {Parent=container, Size=UDim2.new(0,50,0,26), BackgroundColor3=Color3.fromRGB(34,34,34)})
  round(knob,13); stroke(knob, Theme.stroke,1)
  local dot = Create("Frame", {Parent=knob, Size=UDim2.new(0,22,0,22), Position=UDim2.new(0,2,0.5,-11), BackgroundColor3=default and Theme.accent or Color3.fromRGB(130,130,130)})
  round(dot,11)
  local state = default == true
  local function render()
    TweenService:Create(dot, TweenInfo.new(0.18, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Position = UDim2.new(state and 1 or 0, state and -24 or 2, 0.5, -11), BackgroundColor3 = state and Theme.accent or Color3.fromRGB(130,130,130)}):Play()
  end
  knob.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 then state = not state; render(); if onChanged then onChanged(state) end end
  end)
  render()
end

function Components.Slider(parent, labelText, min, max, default, onChanged)
  local container = Create("Frame", {Parent=parent, BackgroundTransparency=1, Size=UDim2.new(1,0,0,44)})
  Create("TextLabel", {Parent=container, BackgroundTransparency=1, Text=labelText, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=14, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), Size=UDim2.new(1,0,0,18)})
  local bar = Create("Frame", {Parent=container, Size=UDim2.new(1,0,0,6), Position=UDim2.new(0,0,0,20), BackgroundColor3=Color3.fromRGB(40,40,40)})
  round(bar,3); stroke(bar, Theme.stroke,1)
  local fill = Create("Frame", {Parent=bar, Size=UDim2.new(0,0,1,0), BackgroundColor3=Theme.accent}); round(fill,3)
  local thumb = Create("Frame", {Parent=container, Size=UDim2.new(0,14,0,14), Position=UDim2.new(0,0,0,17), BackgroundColor3=Theme.accent}); round(thumb,7)
  local valueLbl = Create("TextLabel", {Parent=container, AnchorPoint=Vector2.new(1,0), Position=UDim2.new(1,0,0,0), Size=UDim2.new(0,60,0,18), BackgroundTransparency=1, Text=tostring(default), TextXAlignment=Enum.TextXAlignment.Right, TextColor3=Theme.textDim, TextSize=13, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json")})
  local dragging=false
  local value = math.clamp(default or min, min, max)
  local function render()
    local a = (value-min)/(max-min)
    fill.Size = UDim2.new(a,0,1,0)
    thumb.Position = UDim2.new(a,-7,0,17)
    valueLbl.Text = string.format("%d", math.round(value))
    if onChanged then onChanged(value) end
  end
  local function setFromX(x)
    local rel = (x - bar.AbsolutePosition.X) / bar.AbsoluteSize.X
    value = math.clamp(min + rel*(max-min), min, max); render()
  end
  container.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=true; setFromX(i.Position.X) end end)
  UIS.InputChanged:Connect(function(i) if dragging and (i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch) then setFromX(i.Position.X) end end)
  UIS.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=false end end)
  render()
end

function Components.Dropdown(parent, labelText, items, defaultIndex, onChanged)
  local container = Create("Frame", {Parent=parent, BackgroundTransparency=1, Size=UDim2.new(1,0,0,44)})
  Create("TextLabel", {Parent=container, BackgroundTransparency=1, Text=labelText, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=14, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), Size=UDim2.new(1,0,0,18)})
  local dd = Create("TextButton", {Parent=container, Size=UDim2.new(0,184,0,26), BackgroundColor3=Color3.fromRGB(34,34,34), TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json"), TextSize=14, AutoButtonColor=false, BorderSizePixel=0, Text=""})
  round(dd,8); stroke(dd, Theme.stroke,1); pad(dd,8,0,8,0)
  local choice = Create("TextLabel", {Parent=dd, BackgroundTransparency=1, Size=UDim2.new(1,-16,1,0), TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, FontFace=dd.FontFace, TextSize=14})
  local arrow = Create("TextLabel", {Parent=dd, BackgroundTransparency=1, AnchorPoint=Vector2.new(1,0), Position=UDim2.new(1,0,0,0), Size=UDim2.new(0,16,1,0), Text="â–¼", TextColor3=Theme.textDim, FontFace=dd.FontFace, TextSize=12})
  local listFrame = Create("Frame", {Parent=container, Size=UDim2.new(0,200,0,0), BackgroundColor3=Color3.fromRGB(30,30,30), Visible=false})
  round(listFrame,8); stroke(listFrame, Theme.stroke,1); pad(listFrame,6,6,6,6); listFrame.ZIndex=5
  local scroller = Create("ScrollingFrame", {Parent=listFrame, Size=UDim2.new(1,0,1,0), BackgroundTransparency=1, CanvasSize=UDim2.new(0,0,0,#items*28)})
  local ll = list(scroller,4)
  local selected = math.clamp(defaultIndex or 1, 1, #items)
  local function render()
    choice.Text = items[selected]
    if onChanged then onChanged(items[selected], selected) end
  end
  for i,name in ipairs(items) do
    local opt = Create("TextButton", {Parent=scroller, Size=UDim2.new(1,-4,0,26), BackgroundColor3=Color3.fromRGB(38,38,38), TextColor3=Theme.text, TextXAlignment=Enum.TextXAlignment.Left, Text="  "..name, AutoButtonColor=true})
    round(opt,6)
    opt.MouseButton1Click:Connect(function() selected=i; listFrame.Visible=false; render() end)
  end
  local open=false
  local function setOpen(v)
    open=v; listFrame.Visible=open; TweenService:Create(listFrame, TweenInfo.new(0.12), {Size=UDim2.new(0,200,0, open and 150 or 0)}):Play()
  end
  dd.MouseButton1Click:Connect(function() setOpen(not open) end)
  UIS.InputBegan:Connect(function(i)
    if open and i.UserInputType==Enum.UserInputType.MouseButton1 then
      local pos = UIS:GetMouseLocation(); local a=listFrame.AbsolutePosition; local s=listFrame.AbsoluteSize
      if not (pos.X>a.X and pos.X<a.X+s.X and pos.Y>a.Y and pos.Y<a.Y+s.Y) then setOpen(false) end
    end
  end)
  render()
end

-- Cards
local contentList = Create("UIListLayout", {Parent=content, FillDirection=Enum.FillDirection.Horizontal, Padding=UDim.new(0,16)})
local function card(title)
  local frame = Create("Frame", {Parent=content, Size=UDim2.new(0.5,-8,1,-16), BackgroundColor3=Theme.panelAlt, BorderSizePixel=0})
  round(frame,12); stroke(frame, Theme.stroke,1); pad(frame,18,16,18,16)
  Create("TextLabel", {Parent=frame, Size=UDim2.new(1,0,0,18), BackgroundTransparency=1, Text=title, TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=15, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json", Enum.FontWeight.Medium)})
  return frame
end

local function buildAntiAim()
  local left = card("Anti-aimbot angles")
  local right = card("Fake lag")

  -- Left controls
  Components.Switch(left, "Enabled", true)
  Components.Dropdown(left, "Pitch", {"Off","Down","Zero","Up"}, 1)
  Components.Dropdown(left, "Base yaw", {"Local view","At targets","Opposite"}, 1)
  Components.Slider(left, "Yaw", -180, 180, 0)
  Components.Dropdown(left, "Yaw jitter", {"Off","Offset","Center","Random"}, 1)
  Components.Dropdown(left, "Body yaw", {"Off","Static","Random","Jitter"}, 1)
  Components.Slider(left, "Freestanding body yaw", 0, 100, 0)
  Components.Dropdown(left, "Edge yaw", {"Off","Freestanding"}, 2)
  Components.Dropdown(left, "Freestanding", {"Default","Peek","Tight"}, 1)

  -- Right controls
  Components.Switch(right, "Enabled", true)
  Components.Dropdown(right, "Amount", {"Static","Dynamic"}, 2)
  Components.Slider(right, "Variance", 0, 100, 30)
  Components.Slider(right, "Limit", 0, 100, 60)
  Create("TextLabel", {Parent=right, Size=UDim2.new(1,0,0,18), BackgroundTransparency=1, Text="Other", TextXAlignment=Enum.TextXAlignment.Left, TextColor3=Theme.text, TextSize=14, FontFace=Font.new("rbxasset://fonts/families/GothamSSm.json")})
  Components.Dropdown(right, "Slow motion type", {"Favor high speed","Favor accuracy","Balanced"}, 1)
  Components.Dropdown(right, "Leg movement", {"Off","Sliding","Walking"}, 1)
  Components.Switch(right, "On shot anti-aim", false)
  Components.Switch(right, "Fake peek", false)

  return {left = left, right = right}
end

-- Page registry (only Anti Aim wired for now)
pages["Anti Aim"] = Create("Frame", {Parent=content, BackgroundTransparency=1, Size=UDim2.new(1,0,1,0), Visible=true})
contentList.Parent = pages["Anti Aim"] -- ensure layout applies within page
local cards = buildAntiAim()

-- Select default nav item visually
local defaultNav = navScroll:FindFirstChild("nav_Anti Aim")
if defaultNav and defaultNav:IsA("TextButton") then defaultNav:MouseButton1Click() end

-- Save button feedback
saveBtn.MouseButton1Click:Connect(function()
  local orig = saveBtn.Text
  saveBtn.Text = "Saved âœ“"
  TweenService:Create(saveBtn, TweenInfo.new(0.15), {BackgroundColor3 = Theme.accent:lerp(Color3.new(1,1,1), 0.25)}):Play()
  task.delay(1.1, function()
    saveBtn.Text = orig
    TweenService:Create(saveBtn, TweenInfo.new(0.25), {BackgroundColor3 = Theme.accent}):Play()
  end)
end)
