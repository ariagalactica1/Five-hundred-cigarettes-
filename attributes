-- Exposure Path Finder
-- Place this as a LocalScript in: StarterPlayer > StarterPlayerScripts

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

--------------------------------------------------
-- Helper functions (same as in your Bio-Scanner)
--------------------------------------------------

local function getCharacter(p)
	return p and p.Character or nil
end

local function getPlayerAttr(targetPlayer, attrName)
	if not targetPlayer then return nil end
	local success, result = pcall(function()
		return targetPlayer:GetAttribute(attrName)
	end)
	if success and result ~= nil then
		return result
	end
	return nil
end

local function getCharAttr(char, attrName)
	if not char then return nil end
	local success, result = pcall(function()
		return char:GetAttribute(attrName)
	end)
	if success and result ~= nil then
		return result
	end
	return nil
end

local function getDataValue(targetPlayer, valueName)
	if not targetPlayer then return nil end
	local success, result = pcall(function()
		local data = targetPlayer:FindFirstChild("Data")
		if not data then return nil end
		local valueObj = data:FindFirstChild(valueName)
		if not valueObj then return nil end
		return valueObj.Value
	end)
	if success and result ~= nil then
		return result
	end
	return nil
end

local function getLeaderstats(targetPlayer, statName)
	if not targetPlayer then return nil end
	local success, result = pcall(function()
		local stats = targetPlayer:FindFirstChild("leaderstats")
		if not stats then return nil end
		local statObj = stats:FindFirstChild(statName)
		if not statObj then return nil end
		return statObj.Value
	end)
	if success and result ~= nil then
		return result
	end
	return nil
end

--------------------------------------------------
-- Debug: find exactly WHERE Exposure is stored
--------------------------------------------------

local function debugExposureSource(targetPlayer)
	if not targetPlayer then
		warn("[Exposure] No targetPlayer given")
		return nil
	end

	print("\n================ EXPOSURE DEBUG FOR:", targetPlayer.Name, "================")

	local char = getCharacter(targetPlayer)
	local v

	-- 1) Character attribute
	v = getCharAttr(char, "Exposure")
	if v ~= nil and char then
		warn(("[Exposure] Character attribute -> %s  |  Value = %s")
			:format(char:GetFullName(), tostring(v)))
		return v
	end

	-- 2) Player attribute
	v = getPlayerAttr(targetPlayer, "Exposure")
	if v ~= nil then
		warn(("[Exposure] Player attribute    -> %s  |  Value = %s")
			:format(targetPlayer:GetFullName(), tostring(v)))
		return v
	end

	-- 3) Data folder value
	v = getDataValue(targetPlayer, "Exposure")
	if v ~= nil then
		local dataFolder = targetPlayer:FindFirstChild("Data")
		if dataFolder and dataFolder:FindFirstChild("Exposure") then
			warn(("[Exposure] Data value        -> %s  |  Value = %s")
				:format(dataFolder.Exposure:GetFullName(), tostring(v)))
		else
			warn(("[Exposure] Data value via getDataValue (instance not found) | Value = %s")
				:format(tostring(v)))
		end
		return v
	end

	-- 4) leaderstats value
	v = getLeaderstats(targetPlayer, "Exposure")
	if v ~= nil then
		local ls = targetPlayer:FindFirstChild("leaderstats")
		if ls and ls:FindFirstChild("Exposure") then
			warn(("[Exposure] leaderstats value -> %s  |  Value = %s")
				:format(ls.Exposure:GetFullName(), tostring(v)))
		else
			warn(("[Exposure] leaderstats Exposure via getLeaderstats (instance not found) | Value = %s")
				:format(tostring(v)))
		end
		return v
	end

	warn("[Exposure] Could NOT find Exposure anywhere for player " .. targetPlayer.Name)
	return nil
end

--------------------------------------------------
-- Run it for LocalPlayer
--------------------------------------------------

local function scanLocalPlayerExposure()
	local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	-- small delay so Data/leaderstats have time to load
	task.wait(0.5)
	debugExposureSource(LocalPlayer)
end

-- Run once when this script starts (if already spawned)
if LocalPlayer.Character then
	task.spawn(scanLocalPlayerExposure)
end

-- Run again when you respawn
LocalPlayer.CharacterAdded:Connect(function()
	task.spawn(scanLocalPlayerExposure)
end)

--------------------------------------------------
-- Optional: press L to re-scan manually
--------------------------------------------------

UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.L then
		scanLocalPlayerExposure()
	end
end)
