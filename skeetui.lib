-- LocalScript: Recreate HTML Menu in Roblox GUI
-- Define theme colors (from CSS variables) using Color3.fromRGB
local COLORS = {
    BG_MAIN       = Color3.fromRGB(30, 30, 46),   -- --bg-main (#1e1e2e):contentReference[oaicite:44]{index=44}
    BG_SIDEBAR    = Color3.fromRGB(26, 27, 38),   -- --bg-sidebar (#1a1b26)
    BG_INPUT      = Color3.fromRGB(42, 46, 62),   -- --bg-input (#2a2e3e)
    BORDER        = Color3.fromRGB(65, 72, 104),  -- --border-color (#414868)
    TEXT_PRIMARY  = Color3.fromRGB(192, 202, 245),-- --text-primary (#c0caf5)
    TEXT_SECONDARY= Color3.fromRGB(169, 177, 214),-- --text-secondary (#a9b1d6)
    ACCENT_PRIMARY= Color3.fromRGB(122, 162, 247),-- --accent-primary (#7aa2f7)
    ACCENT_SECOND = Color3.fromRGB(247, 118, 142),-- --accent-secondary (#f7768e)
    ACCENT_GREEN  = Color3.fromRGB(158, 206, 106) -- --accent-green (#9ece6a)
}
-- Load Inter font (asset from Roblox Marketplace) for use in TextLabels/Buttons
local interFontId = 12187365364  -- Asset ID for "Inter" font:contentReference[oaicite:45]{index=45}
local fontInter    = Font.fromId(interFontId)  -- default weight (Regular)
local fontInterBold= Font.new("rbxassetid://"..interFontId, Enum.FontWeight.Bold)  -- Bold weight

-- Create ScreenGui
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SettingsMenuGui"
screenGui.IgnoreGuiInset = true  -- use full screen without offset
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Panel Frame (modal container)
local panel = Instance.new("Frame")
panel.Name = "SettingsPanel"
panel.BackgroundColor3 = COLORS.BG_MAIN
panel.BorderSizePixel = 0
panel.AnchorPoint = Vector2.new(0.5, 0.5)
panel.Position = UDim2.new(0.5, 0, 0.5, 0)
panel.Size = UDim2.new(0.95, 0, 0.9, 0)  -- start at 95% width, 90% height
-- Constrain panel to max 900x700 pixels
local panelSizeConstraint = Instance.new("UISizeConstraint")
panelSizeConstraint.MaxSize = Vector2.new(900, 700)
panelSizeConstraint.Parent = panel
-- Rounded corners (12px radius)
local panelCorner = Instance.new("UICorner")
panelCorner.CornerRadius = UDim.new(0, 12)
panelCorner.Parent = panel
panel.Parent = screenGui

-- Panel Header
local header = Instance.new("Frame")
header.Name = "PanelHeader"
header.BackgroundColor3 = COLORS.BG_SIDEBAR
header.BorderSizePixel = 0
header.Size = UDim2.new(1, 0, 0, 50)  -- full width, 50px tall
header.Position = UDim2.new(0, 0, 0, 0)
header.Parent = panel
-- Bottom border line (1px)
local headerBorder = Instance.new("Frame")
headerBorder.BackgroundColor3 = COLORS.BORDER
headerBorder.BorderSizePixel = 0
headerBorder.Size = UDim2.new(1, 0, 0, 1)
headerBorder.Position = UDim2.new(0, 0, 1, 0)  -- anchored to bottom of header
headerBorder.Parent = header
-- Header Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "Title"
titleLabel.BackgroundTransparency = 1
titleLabel.Position = UDim2.new(0, 20, 0.5, 0)  -- 20px from left, vertically centered
titleLabel.AnchorPoint = Vector2.new(0, 0.5)
titleLabel.FontFace = fontInterBold
titleLabel.Text = "Settings Panel"
titleLabel.TextColor3 = COLORS.TEXT_PRIMARY
titleLabel.TextSize = 18  -- ~1.2em
titleLabel.Parent = header

-- Header Controls (container for toggle & dropdown in header)
local headerControls = Instance.new("Frame")
headerControls.Name = "HeaderControls"
headerControls.BackgroundTransparency = 1
headerControls.AnchorPoint = Vector2.new(1, 0.5)
headerControls.Position = UDim2.new(1, -20, 0.5, 0)  -- 20px from right, centered vertically
headerControls.Size = UDim2.new(0, 0, 1, 0)  -- width will auto-fit children, height same as header
headerControls.AutomaticSize = Enum.AutomaticSize.X  -- auto width
headerControls.Parent = header
local controlsLayout = Instance.new("UIListLayout")
controlsLayout.FillDirection = Enum.FillDirection.Horizontal
controlsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
controlsLayout.VerticalAlignment = Enum.VerticalAlignment.Center
controlsLayout.Padding = UDim.new(0, 20)  -- 20px gap between controls
controlsLayout.Parent = headerControls

-- Header "Mode" dropdown label and button
local modeControl = Instance.new("Frame")
modeControl.Name = "ModeControl"
modeControl.BackgroundTransparency = 1
modeControl.AutomaticSize = Enum.AutomaticSize.XY
modeControl.Parent = headerControls
local modeLayout = Instance.new("UIListLayout")
modeLayout.FillDirection = Enum.FillDirection.Horizontal
modeLayout.VerticalAlignment = Enum.VerticalAlignment.Center
modeLayout.Parent = modeControl
-- Label
local modeLabel = Instance.new("TextLabel")
modeLabel.BackgroundTransparency = 1
modeLabel.FontFace = fontInter
modeLabel.Text = "Mode:"
modeLabel.TextColor3 = COLORS.TEXT_SECONDARY
modeLabel.TextSize = 14
modeLabel.Parent = modeControl
-- Dropdown button
local modeDropdown = Instance.new("TextButton")
modeDropdown.Name = "ModeDropdown"
modeDropdown.AutoButtonColor = false  -- we'll handle hover color
modeDropdown.FontFace = fontInter
modeDropdown.Text = "Stable Diffusion  ‚ñº"  -- default option with arrow
modeDropdown.TextColor3 = COLORS.TEXT_PRIMARY
modeDropdown.TextSize = 14
modeDropdown.BackgroundColor3 = COLORS.BG_INPUT
modeDropdown.Size = UDim2.new(0, 0, 0, 32)
modeDropdown.AutomaticSize = Enum.AutomaticSize.X  -- width grows to text + padding
-- Style the dropdown button with padding and border
local ddPadding = Instance.new("UIPadding")
ddPadding.PaddingLeft = UDim.new(0, 10)
ddPadding.PaddingRight = UDim.new(0, 30)  -- extra right padding for arrow icon spacing
ddPadding.PaddingTop = UDim.new(0, 6)
ddPadding.PaddingBottom = UDim.new(0, 6)
ddPadding.Parent = modeDropdown
local ddCorner = Instance.new("UICorner")
ddCorner.CornerRadius = UDim.new(0, 5)
ddCorner.Parent = modeDropdown
local ddStroke = Instance.new("UIStroke")
ddStroke.Color = COLORS.BORDER
ddStroke.Thickness = 1
ddStroke.Parent = modeDropdown
modeDropdown.Parent = modeControl

-- Dropdown options list (initially hidden)
local modeOptionsFrame = Instance.new("Frame")
modeOptionsFrame.Name = "ModeOptions"
modeOptionsFrame.BackgroundColor3 = COLORS.BG_INPUT
modeOptionsFrame.BorderSizePixel = 0
modeOptionsFrame.Visible = false
-- We'll position this frame dynamically when showing, relative to modeDropdown's absolute position
local optionsCorner = Instance.new("UICorner")
optionsCorner.CornerRadius = UDim.new(0, 5)
optionsCorner.Parent = modeOptionsFrame
local optionsStroke = Instance.new("UIStroke")
optionsStroke.Color = COLORS.BORDER
optionsStroke.Thickness = 1
optionsStroke.Parent = modeOptionsFrame
modeOptionsFrame.Parent = panel  -- parent to panel (overlay on content)

-- Populate dropdown options
local modes = {"Stable Diffusion", "NovelAI", "ComfyUI"}
modeOptionsFrame.Size = UDim2.new(0, 140, 0, #modes * 24)  -- width to fit text, height for all options
local optLayout = Instance.new("UIListLayout")
optLayout.Parent = modeOptionsFrame
for _, option in ipairs(modes) do
    local optButton = Instance.new("TextButton")
    optButton.Name = "Option_"..option
    optButton.FontFace = fontInter
    optButton.Text = option
    optButton.TextColor3 = COLORS.TEXT_PRIMARY
    optButton.TextSize = 14
    optButton.BackgroundColor3 = COLORS.BG_INPUT
    optButton.AutoButtonColor = false
    optButton.Size = UDim2.new(1, 0, 0, 24)
    optButton.Parent = modeOptionsFrame
    -- Hover effect for options
    optButton.MouseEnter:Connect(function()
        optButton.BackgroundColor3 = COLORS.BORDER  -- slight highlight
    end)
    optButton.MouseLeave:Connect(function()
        optButton.BackgroundColor3 = COLORS.BG_INPUT
    end)
    -- Selection behavior
    optButton.MouseButton1Click:Connect(function()
        modeDropdown.Text = option.."  ‚ñº"
        modeOptionsFrame.Visible = false
    end)
end

-- Header "Enabled" toggle (with label)
local enabledControl = Instance.new("Frame")
enabledControl.Name = "EnabledControl"
enabledControl.BackgroundTransparency = 1
enabledControl.AutomaticSize = Enum.AutomaticSize.XY
enabledControl.Parent = headerControls
local enabledLayout = Instance.new("UIListLayout")
enabledLayout.FillDirection = Enum.FillDirection.Horizontal
enabledLayout.VerticalAlignment = Enum.VerticalAlignment.Center
enabledLayout.Padding = UDim.new(0, 8)
enabledLayout.Parent = enabledControl
-- Label
local enabledLabel = Instance.new("TextLabel")
enabledLabel.BackgroundTransparency = 1
enabledLabel.FontFace = fontInter
enabledLabel.Text = "Enabled"
enabledLabel.TextColor3 = COLORS.TEXT_SECONDARY
enabledLabel.TextSize = 14
enabledLabel.Parent = enabledControl
-- Toggle switch frame (44x24)
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "EnabledToggle"
toggleButton.AutoButtonColor = false
toggleButton.BackgroundColor3 = Color3.fromRGB(59, 66, 97)  -- #3b4261 off-state track color
toggleButton.Size = UDim2.new(0, 44, 0, 24)
toggleButton.Text = ""  -- no text, just a clickable frame
-- Round toggle track
local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 12)
toggleCorner.Parent = toggleButton
toggleButton.Parent = enabledControl
-- Toggle knob (white circle)
local knob = Instance.new("Frame")
knob.Name = "Knob"
knob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
knob.Size = UDim2.new(0, 18, 0, 18)
knob.Position = UDim2.new(0, 3, 0.5, 0)  -- 3px from left, centered vertically in track
knob.AnchorPoint = Vector2.new(0, 0.5)
local knobCorner = Instance.new("UICorner")
knobCorner.CornerRadius = UDim.new(1, 0)  -- make it a circle
knobCorner.Parent = knob
knob.Parent = toggleButton

-- Toggle behavior
local toggleOn = false
local function setToggleState(on)
    toggleOn = on
    if on then
        -- ON: green track, knob to right
        toggleButton.BackgroundColor3 = COLORS.ACCENT_GREEN
        knob:TweenPosition(UDim2.new(0, 23, 0.5, 0), "Out", "Quad", 0.2, true)
    else
        -- OFF: gray track, knob to left
        toggleButton.BackgroundColor3 = Color3.fromRGB(59, 66, 97)  -- off-state color
        knob:TweenPosition(UDim2.new(0, 3, 0.5, 0), "Out", "Quad", 0.2, true)
    end
end
toggleButton.MouseButton1Click:Connect(function()
    setToggleState(not toggleOn)
end)
-- (Clicking the label could also toggle, by connecting enabledLabel or the frame's click event if desired)

-- Panel Body (container for sidebar + content)
local body = Instance.new("Frame")
body.Name = "PanelBody"
body.BackgroundTransparency = 1
body.Position = UDim2.new(0, 0, 0, 50)  -- below header
body.Size = UDim2.new(1, 0, 1, -50)    -- full panel width, remaining height
body.Parent = panel

-- Sidebar Frame
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.BackgroundColor3 = COLORS.BG_SIDEBAR
sidebar.BorderSizePixel = 0
sidebar.Size = UDim2.new(0, 180, 1, 0)  -- 180px width, full height of body
sidebar.Position = UDim2.new(0, 0, 0, 0)
sidebar.Parent = body
-- Right border line
local sidebarBorder = Instance.new("Frame")
sidebarBorder.BackgroundColor3 = COLORS.BORDER
sidebarBorder.BorderSizePixel = 0
sidebarBorder.Size = UDim2.new(0, 1, 1, 0)
sidebarBorder.Position = UDim2.new(1, 0, 0, 0)
sidebarBorder.Parent = sidebar
-- Sidebar list layout
local navList = Instance.new("UIListLayout")
navList.FillDirection = Enum.FillDirection.Vertical
navList.SortOrder = Enum.SortOrder.LayoutOrder
navList.Parent = sidebar
-- Sidebar padding (15px top & bottom)
local sidebarPad = Instance.new("UIPadding")
sidebarPad.PaddingTop = UDim.new(0, 15)
sidebarPad.PaddingBottom = UDim.new(0, 15)
sidebarPad.Parent = sidebar

-- Content Area Frame (holds category content frames)
local contentArea = Instance.new("Frame")
contentArea.Name = "ContentArea"
contentArea.BackgroundColor3 = COLORS.BG_MAIN  -- same as panel background
contentArea.BorderSizePixel = 0
contentArea.Position = UDim2.new(0, 180, 0, 0)
contentArea.Size = UDim2.new(1, -180, 1, 0)  -- remaining width, full height
contentArea.Parent = body

-- Define categories and create nav buttons + content frames for each
local categories = {"General", "Appearance", "Advanced"}
local categoryContentFrames = {}  -- to store references
local activeCategoryIndex = 1

for i, catName in ipairs(categories) do
    -- Nav Button for category
    local navButton = Instance.new("TextButton")
    navButton.Name = "Nav"..catName
    navButton.FontFace = fontInter
    navButton.Text = catName
    navButton.TextSize = 14
    navButton.TextXAlignment = Enum.TextXAlignment.Left
    navButton.AutoButtonColor = false
    navButton.BackgroundTransparency = 1  -- we'll use custom highlight frames
    navButton.Size = UDim2.new(1, 0, 0, 36)  -- full width of sidebar, 36px height
    navButton.LayoutOrder = i
    navButton.TextColor3 = COLORS.TEXT_SECONDARY
    navButton.Parent = sidebar
    -- Padding inside nav button (for left indent and vertical padding)
    local navPad = Instance.new("UIPadding")
    navPad.PaddingLeft = UDim.new(0, 20)
    navPad.PaddingRight = UDim.new(0, 20)
    navPad.PaddingTop = UDim.new(0, 10)
    navPad.PaddingBottom = UDim.new(0, 10)
    navPad.Parent = navButton
    -- Highlight bar (3px) for active state
    local highlight = Instance.new("Frame")
    highlight.Name = "Highlight"
    highlight.BackgroundColor3 = COLORS.ACCENT_PRIMARY
    highlight.BorderSizePixel = 0
    highlight.Size = UDim2.new(0, 3, 1, 0)
    highlight.Position = UDim2.new(0, 0, 0, 0)
    highlight.Visible = false  -- only visible for active tab
    highlight.Parent = navButton

    -- Mouse hover effects
    navButton.MouseEnter:Connect(function()
        if i ~= activeCategoryIndex then
            -- Hover: light blue background (10% opacity accent)
            navButton.BackgroundColor3 = COLORS.ACCENT_PRIMARY
            navButton.BackgroundTransparency = 0.9
        end
    end)
    navButton.MouseLeave:Connect(function()
        if i ~= activeCategoryIndex then
            -- Remove hover highlight
            navButton.BackgroundTransparency = 1
        end
    end)

    -- Create corresponding content frame
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = catName.."Content"
    contentFrame.BackgroundTransparency = 1
    contentFrame.Size = UDim2.new(1, 0, 1, 0)
    contentFrame.Visible = false  -- all but one will be hidden initially
    contentFrame.Parent = contentArea
    categoryContentFrames[i] = contentFrame

    -- Populate content for each category
    if catName == "General" then
        -- General Settings content:
        -- Group 1: General Settings (two toggles)
        local group1 = Instance.new("Frame")
        group1.Name = "GeneralGroup"
        group1.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        group1.BackgroundTransparency = 0.9  -- 10% opaque black
        group1.Size = UDim2.new(1, -2*25, 0, 0)  -- width minus horizontal padding, auto height
        group1.Position = UDim2.new(0, 0, 0, 0)
        group1.AutomaticSize = Enum.AutomaticSize.Y
        local group1Stroke = Instance.new("UIStroke")
        group1Stroke.Color = COLORS.BORDER
        group1Stroke.Thickness = 1
        group1Stroke.Parent = group1
        local group1Corner = Instance.new("UICorner")
        group1Corner.CornerRadius = UDim.new(0, 8)
        group1Corner.Parent = group1
        group1.Parent = contentFrame
        -- Group internal padding
        local group1Pad = Instance.new("UIPadding")
        group1Pad.PaddingTop = UDim.new(0, 20)
        group1Pad.PaddingBottom = UDim.new(0, 20)
        group1Pad.PaddingLeft = UDim.new(0, 20)
        group1Pad.PaddingRight = UDim.new(0, 20)
        group1Pad.Parent = group1
        -- Group Title
        local group1Title = Instance.new("TextLabel")
        group1Title.Name = "Title"
        group1Title.BackgroundTransparency = 1
        group1Title.FontFace = fontInterBold  -- semi-bold (600) approximated with bold
        group1Title.Text = "General Settings"
        group1Title.TextColor3 = COLORS.ACCENT_GREEN
        group1Title.TextSize = 16
        group1Title.TextXAlignment = Enum.TextXAlignment.Left
        group1Title.Size = UDim2.new(1, 0, 0, 0)
        group1Title.AutomaticSize = Enum.AutomaticSize.Y
        group1Title.Parent = group1
        local titleUnderline = Instance.new("Frame")
        titleUnderline.BackgroundColor3 = COLORS.BORDER
        titleUnderline.BorderSizePixel = 0
        titleUnderline.Size = UDim2.new(1, 0, 0, 1)
        titleUnderline.Position = UDim2.new(0, 0, 1, -1)
        titleUnderline.Parent = group1Title
        -- Layout for content in this group
        local group1Layout = Instance.new("UIListLayout")
        group1Layout.SortOrder = Enum.SortOrder.LayoutOrder
        group1Layout.Padding = UDim.new(0, 15)
        group1Layout.Parent = group1

        -- Toggle A
        local toggleAFrame = Instance.new("Frame")
        toggleAFrame.BackgroundTransparency = 1
        toggleAFrame.Size = UDim2.new(1, 0, 0, 24)
        toggleAFrame.LayoutOrder = 1
        toggleAFrame.Parent = group1
        local toggleALabel = Instance.new("TextLabel")
        toggleALabel.BackgroundTransparency = 1
        toggleALabel.FontFace = fontInter
        toggleALabel.Text = "Enable Feature A"
        toggleALabel.TextColor3 = COLORS.TEXT_SECONDARY
        toggleALabel.TextSize = 14
        toggleALabel.TextXAlignment = Enum.TextXAlignment.Left
        toggleALabel.Size = UDim2.new(1, -54, 1, 0)  -- leave space for toggle switch on the right
        toggleALabel.Parent = toggleAFrame
        local toggleAButton = toggleButton:Clone()  -- clone the header toggle
        toggleAButton.Name = "ToggleFeatureA"
        toggleAButton.Position = UDim2.new(1, -44, 0, 0)  -- align to right of frame
        toggleAButton.AnchorPoint = Vector2.new(1, 0)
        toggleAButton.Parent = toggleAFrame
        -- Clone knob as well (since clone only copied the TextButton)
        local knobA = knob:Clone()
        knobA.Parent = toggleAButton
        -- Script the toggle similarly
        local onA = false
        toggleAButton.MouseButton1Click:Connect(function()
            onA = not onA
            if onA then
                toggleAButton.BackgroundColor3 = COLORS.ACCENT_GREEN
                knobA:TweenPosition(UDim2.new(0, 23, 0.5, 0), "Out", "Quad", 0.2, true)
            else
                toggleAButton.BackgroundColor3 = Color3.fromRGB(59, 66, 97)
                knobA:TweenPosition(UDim2.new(0, 3, 0.5, 0), "Out", "Quad", 0.2, true)
            end
        end)

        -- Toggle B (similarly)
        local toggleBFrame = toggleAFrame:Clone()
        toggleBFrame.LayoutOrder = 2
        toggleBFrame.Parent = group1
        toggleBFrame:FindFirstChild("TextLabel").Text = "Enable Feature B"
        local toggleBButton = toggleBFrame:FindFirstChild("EnabledToggle") or toggleBFrame:FindFirstChild("ToggleFeatureA")
        toggleBButton.Name = "ToggleFeatureB"
        local knobB = toggleBButton:FindFirstChild("Knob")
        local onB = false
        toggleBButton.MouseButton1Click:Connect(function()
            onB = not onB
            if onB then
                toggleBButton.BackgroundColor3 = COLORS.ACCENT_GREEN
                knobB:TweenPosition(UDim2.new(0, 23, 0.5, 0), "Out", "Quad", 0.2, true)
            else
                toggleBButton.BackgroundColor3 = Color3.fromRGB(59, 66, 97)
                knobB:TweenPosition(UDim2.new(0, 3, 0.5, 0), "Out", "Quad", 0.2, true)
            end
        end)

        -- Group 2: Audio Settings (slider example)
        local group2 = Instance.new("Frame")
        group2.Name = "AudioGroup"
        group2.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        group2.BackgroundTransparency = 0.9
        group2.Size = UDim2.new(1, -2*25, 0, 0)
        group2.AutomaticSize = Enum.AutomaticSize.Y
        local group2Stroke = Instance.new("UIStroke")
        group2Stroke.Color = COLORS.BORDER
        group2Stroke.Thickness = 1
        group2Stroke.Parent = group2
        local group2Corner = Instance.new("UICorner")
        group2Corner.CornerRadius = UDim.new(0, 8)
        group2Corner.Parent = group2
        group2.Parent = contentFrame
        local group2Pad = group1Pad:Clone()
        group2Pad.Parent = group2
        local group2Title = group1Title:Clone()
        group2Title.Text = "Audio Settings"
        group2Title.Parent = group2
        local group2Layout = group1Layout:Clone()
        group2Layout.Parent = group2

        -- Volume slider label
        local volumeLabel = Instance.new("TextLabel")
        volumeLabel.BackgroundTransparency = 1
        volumeLabel.FontFace = fontInter
        volumeLabel.Text = "Volume"
        volumeLabel.TextColor3 = COLORS.TEXT_SECONDARY
        volumeLabel.TextSize = 14
        volumeLabel.TextXAlignment = Enum.TextXAlignment.Left
        volumeLabel.Size = UDim2.new(1, 0, 0, 18)
        volumeLabel.LayoutOrder = 1
        volumeLabel.Parent = group2

        -- Slider container (for track + value display)
        local sliderContainer = Instance.new("Frame")
        sliderContainer.BackgroundTransparency = 1
        sliderContainer.Size = UDim2.new(1, 0, 0, 30)  -- enough height for knob
        sliderContainer.LayoutOrder = 2
        sliderContainer.Parent = group2
        local sliderLayout = Instance.new("UIListLayout")
        sliderLayout.FillDirection = Enum.FillDirection.Horizontal
        sliderLayout.VerticalAlignment = Enum.VerticalAlignment.Center
        sliderLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
        sliderLayout.Padding = UDim.new(0, 10)
        sliderLayout.Parent = sliderContainer

        -- Slider track
        local sliderTrack = Instance.new("Frame")
        sliderTrack.Name = "SliderTrack"
        sliderTrack.BackgroundColor3 = COLORS.BORDER
        sliderTrack.BorderSizePixel = 0
        sliderTrack.Size = UDim2.new(0, 200, 0, 4)
        local trackCorner = Instance.new("UICorner")
        trackCorner.CornerRadius = UDim.new(0, 2)
        trackCorner.Parent = sliderTrack
        sliderTrack.Parent = sliderContainer
        -- Slider fill
        local sliderFill = Instance.new("Frame")
        sliderFill.Name = "SliderFill"
        sliderFill.BackgroundColor3 = COLORS.ACCENT_PRIMARY
        sliderFill.BorderSizePixel = 0
        sliderFill.Size = UDim2.new(0, 0, 1, 0)  -- width 0 initially, height same as track
        local fillCorner = Instance.new("UICorner")
        fillCorner.CornerRadius = UDim.new(0, 2)
        fillCorner.Parent = sliderFill
        sliderFill.Parent = sliderTrack
        -- Slider knob (draggable)
        local sliderKnob = Instance.new("TextButton")
        sliderKnob.Name = "SliderKnob"
        sliderKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        sliderKnob.BorderSizePixel = 0
        sliderKnob.AutoButtonColor = false
        sliderKnob.Size = UDim2.new(0, 18, 0, 18)
        sliderKnob.Position = UDim2.new(0, 0, 0.5, 0)  -- will adjust via script
        sliderKnob.AnchorPoint = Vector2.new(0, 0.5)
        local knobCorner2 = Instance.new("UICorner")
        knobCorner2.CornerRadius = UDim.new(1, 0)
        knobCorner2.Parent = sliderKnob
        sliderKnob.Parent = sliderContainer
        -- Value display label
        local valueLabel = Instance.new("TextLabel")
        valueLabel.BackgroundTransparency = 1
        valueLabel.FontFace = fontInter
        valueLabel.Text = "50"  -- initial value
        valueLabel.TextColor3 = COLORS.TEXT_PRIMARY
        valueLabel.TextSize = 14
        valueLabel.Size = UDim2.new(0, 30, 0, 18)
        valueLabel.LayoutOrder = 3
        valueLabel.Parent = sliderContainer

        -- Slider script: make knob draggable and update fill/value
        local trackWidth = 200
        local knobWidth = 18
        local dragging = false
        local uis = game:GetService("UserInputService")
        local mouse = player:GetMouse()
        local function updateSlider(inputX)
            -- Convert global X to relative position on track
            local relX = inputX - sliderTrack.AbsolutePosition.X
            relX = math.clamp(relX, 0, trackWidth - knobWidth)
            -- Move knob
            sliderKnob.Position = UDim2.new(0, relX, 0.5, 0)
            -- Update fill width (to knob's right edge)
            sliderFill.Size = UDim2.new(0, relX + knobWidth, 1, 0)
            -- Update value label (0-100)
            local percent = math.floor((relX / (trackWidth - knobWidth)) * 100 + 0.5)
            valueLabel.Text = tostring(percent)
        end
        -- Initialize slider at 50%
        local initialX = math.floor((50/100) * (trackWidth - knobWidth))
        sliderKnob.Position = UDim2.new(0, initialX, 0.5, 0)
        sliderFill.Size = UDim2.new(0, initialX + knobWidth, 1, 0)
        -- Drag events
        sliderKnob.MouseButton1Down:Connect(function()
            dragging = true
        end)
        uis.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        mouse.Move:Connect(function()
            if dragging then
                updateSlider(mouse.X)
            end
        end)
        -- Also allow clicking on track to jump to position
        sliderTrack.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                updateSlider(input.Position.X)
                dragging = true
            end
        end)
        sliderTrack.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
    elseif catName == "Appearance" then
        -- Appearance Settings content:
        local group = Instance.new("Frame")
        group.Name = "AppearanceGroup"
        group.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        group.BackgroundTransparency = 0.9
        group.Size = UDim2.new(1, -2*25, 0, 0)
        group.AutomaticSize = Enum.AutomaticSize.Y
        local groupStroke = Instance.new("UIStroke")
        groupStroke.Color = COLORS.BORDER
        groupStroke.Thickness = 1
        groupStroke.Parent = group
        local groupCorner = Instance.new("UICorner")
        groupCorner.CornerRadius = UDim.new(0, 8)
        groupCorner.Parent = group
        group.Parent = contentFrame
        local groupPad = Instance.new("UIPadding")
        groupPad.PaddingTop = UDim.new(0, 20)
        groupPad.PaddingBottom = UDim.new(0, 20)
        groupPad.PaddingLeft = UDim.new(0, 20)
        groupPad.PaddingRight = UDim.new(0, 20)
        groupPad.Parent = group
        local groupTitle = Instance.new("TextLabel")
        groupTitle.BackgroundTransparency = 1
        groupTitle.FontFace = fontInterBold
        groupTitle.Text = "Appearance"
        groupTitle.TextColor3 = COLORS.ACCENT_GREEN
        groupTitle.TextSize = 16
        groupTitle.TextXAlignment = Enum.TextXAlignment.Left
        groupTitle.Size = UDim2.new(1, 0, 0, 0)
        groupTitle.AutomaticSize = Enum.AutomaticSize.Y
        groupTitle.Parent = group
        local titleLine = Instance.new("Frame")
        titleLine.BackgroundColor3 = COLORS.BORDER
        titleLine.BorderSizePixel = 0
        titleLine.Size = UDim2.new(1, 0, 0, 1)
        titleLine.Position = UDim2.new(0, 0, 1, -1)
        titleLine.Parent = groupTitle
        local groupLayout = Instance.new("UIListLayout")
        groupLayout.SortOrder = Enum.SortOrder.LayoutOrder
        groupLayout.Padding = UDim.new(0, 15)
        groupLayout.Parent = group

        -- Theme dropdown
        local themeFrame = Instance.new("Frame")
        themeFrame.BackgroundTransparency = 1
        themeFrame.Size = UDim2.new(1, 0, 0, 32)
        themeFrame.LayoutOrder = 1
        themeFrame.Parent = group
        local themeLabel = Instance.new("TextLabel")
        themeLabel.BackgroundTransparency = 1
        themeLabel.FontFace = fontInter
        themeLabel.Text = "Theme:"
        themeLabel.TextColor3 = COLORS.TEXT_SECONDARY
        themeLabel.TextSize = 14
        themeLabel.TextXAlignment = Enum.TextXAlignment.Left
        themeLabel.Position = UDim2.new(0, 0, 0, 5)
        themeLabel.Size = UDim2.new(0, 50, 1, 0)
        themeLabel.Parent = themeFrame
        local themeDropdown = modeDropdown:Clone()
        themeDropdown.Name = "ThemeDropdown"
        themeDropdown.Text = "Dark  ‚ñº"
        themeDropdown.Position = UDim2.new(0, 60, 0, 0)
        themeDropdown.Parent = themeFrame
        -- Reuse options list for theme
        local themeOptions = modeOptionsFrame:Clone()
        themeOptions.Name = "ThemeOptions"
        themeOptions.Parent = panel
        themeOptions.Visible = false
        -- Options for Light/Dark
        for _, child in ipairs(themeOptions:GetChildren()) do
            if child:IsA("TextButton") then child:Destroy() end
        end
        themeOptions.Size = UDim2.new(0, 100, 0, 48)
        local themeOptLayout = themeOptions:FindFirstChildOfClass("UIListLayout")
        if themeOptLayout then themeOptLayout:Destroy() end
        local themeListLayout = Instance.new("UIListLayout")
        themeListLayout.Parent = themeOptions
        local themes = {"Dark", "Light"}
        for _, t in ipairs(themes) do
            local tbtn = Instance.new("TextButton")
            tbtn.FontFace = fontInter
            tbtn.Text = t
            tbtn.TextColor3 = COLORS.TEXT_PRIMARY
            tbtn.TextSize = 14
            tbtn.BackgroundColor3 = COLORS.BG_INPUT
            tbtn.AutoButtonColor = false
            tbtn.Size = UDim2.new(1, 0, 0, 24)
            tbtn.Parent = themeOptions
            tbtn.MouseEnter:Connect(function()
                tbtn.BackgroundColor3 = COLORS.BORDER
            end)
            tbtn.MouseLeave:Connect(function()
                tbtn.BackgroundColor3 = COLORS.BG_INPUT
            end)
            tbtn.MouseButton1Click:Connect(function()
                themeDropdown.Text = t.."  ‚ñº"
                themeOptions.Visible = false
            end)
        end
        -- Connect themeDropdown to show themeOptions
        themeDropdown.MouseButton1Click:Connect(function()
            local absPos = themeDropdown.AbsolutePosition
            themeOptions.Position = UDim2.new(0, absPos.X - panel.AbsolutePosition.X,
                                             0, absPos.Y - panel.AbsolutePosition.Y + themeDropdown.AbsoluteSize.Y)
            themeOptions.ZIndex = 5
            themeDropdown.ZIndex = 5
            for _, btn in ipairs(themeOptions:GetChildren()) do
                if btn:IsA("TextButton") then btn.ZIndex = 5 end
            end
            themeOptions.Visible = not themeOptions.Visible
        end)
        -- Toggle for Dark Mode (for demonstration)
        local darkModeFrame = enabledControl:Clone()
        darkModeFrame.LayoutOrder = 2
        darkModeFrame.Parent = group
        local darkLabel = darkModeFrame:FindFirstChild("TextLabel")
        darkLabel.Text = "Dark Mode"
        local darkToggle = darkModeFrame:FindFirstChild("EnabledToggle") or darkModeFrame:FindFirstChild("EnabledToggle")
        if darkToggle then
            -- Reset toggle state
            darkToggle.BackgroundColor3 = Color3.fromRGB(59, 66, 97)
            local darkKnob = darkToggle:FindFirstChild("Knob")
            if darkKnob then
                darkKnob.Position = UDim2.new(0, 3, 0.5, 0)
            end
            local onDark = true
            -- Assume default "Dark Mode" is on since theme is Dark
            darkToggle.BackgroundColor3 = COLORS.ACCENT_GREEN
            if darkToggle:FindFirstChild("Knob") then
                darkToggle.Knob.Position = UDim2.new(0, 23, 0.5, 0)
            end
            onDark = true
            darkToggle.MouseButton1Click:Connect(function()
                onDark = not onDark
                if onDark then
                    darkToggle.BackgroundColor3 = COLORS.ACCENT_GREEN
                    darkToggle.Knob:TweenPosition(UDim2.new(0, 23, 0.5, 0), "Out", "Quad", 0.2, true)
                    themeDropdown.Text = "Dark  ‚ñº"
                else
                    darkToggle.BackgroundColor3 = Color3.fromRGB(59, 66, 97)
                    darkToggle.Knob:TweenPosition(UDim2.new(0, 3, 0.5, 0), "Out", "Quad", 0.2, true)
                    themeDropdown.Text = "Light  ‚ñº"
                end
            end)
        end
    elseif catName == "Advanced" then
        -- Advanced Settings content:
        local group = Instance.new("Frame")
        group.Name = "AdvancedGroup"
        group.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        group.BackgroundTransparency = 0.9
        group.Size = UDim2.new(1, -2*25, 0, 0)
        group.AutomaticSize = Enum.AutomaticSize.Y
        local groupStroke = Instance.new("UIStroke")
        groupStroke.Color = COLORS.BORDER
        groupStroke.Thickness = 1
        groupStroke.Parent = group
        local groupCorner = Instance.new("UICorner")
        groupCorner.CornerRadius = UDim.new(0, 8)
        groupCorner.Parent = group
        group.Parent = contentFrame
        local groupPad = Instance.new("UIPadding")
        groupPad.PaddingTop = UDim.new(0, 20)
        groupPad.PaddingBottom = UDim.new(0, 20)
        groupPad.PaddingLeft = UDim.new(0, 20)
        groupPad.PaddingRight = UDim.new(0, 20)
        groupPad.Parent = group
        local groupTitle = Instance.new("TextLabel")
        groupTitle.BackgroundTransparency = 1
        groupTitle.FontFace = fontInterBold
        groupTitle.Text = "Advanced"
        groupTitle.TextColor3 = COLORS.ACCENT_GREEN
        groupTitle.TextSize = 16
        groupTitle.TextXAlignment = Enum.TextXAlignment.Left
        groupTitle.Size = UDim2.new(1, 0, 0, 0)
        groupTitle.AutomaticSize = Enum.AutomaticSize.Y
        groupTitle.Parent = group
        local titleLine = Instance.new("Frame")
        titleLine.BackgroundColor3 = COLORS.BORDER
        titleLine.BorderSizePixel = 0
        titleLine.Size = UDim2.new(1, 0, 0, 1)
        titleLine.Position = UDim2.new(0, 0, 1, -1)
        titleLine.Parent = groupTitle
        local groupLayout = Instance.new("UIListLayout")
        groupLayout.SortOrder = Enum.SortOrder.LayoutOrder
        groupLayout.Padding = UDim.new(0, 15)
        groupLayout.Parent = group

        -- Reset to Defaults and Delete Data buttons (horizontal group)
        local buttonRow = Instance.new("Frame")
        buttonRow.BackgroundTransparency = 1
        buttonRow.Size = UDim2.new(1, 0, 0, 0)
        buttonRow.AutomaticSize = Enum.AutomaticSize.Y
        buttonRow.LayoutOrder = 1
        buttonRow.Parent = group
        local buttonRowLayout = Instance.new("UIListLayout")
        buttonRowLayout.FillDirection = Enum.FillDirection.Horizontal
        buttonRowLayout.Padding = UDim.new(0, 10)
        buttonRowLayout.Parent = buttonRow

        -- Reset button (base style, with icon)
        local resetBtn = Instance.new("TextButton")
        resetBtn.AutoButtonColor = false
        resetBtn.FontFace = fontInter
        resetBtn.Text = "üîÑ Reset to Default"
        resetBtn.TextColor3 = COLORS.TEXT_PRIMARY
        resetBtn.TextSize = 14
        resetBtn.BackgroundColor3 = Color3.fromRGB(41, 46, 66)  -- base bg #292e42:contentReference[oaicite:46]{index=46}
        resetBtn.Size = UDim2.new(0, 0, 0, 0)
        resetBtn.AutomaticSize = Enum.AutomaticSize.XY
        local resetPad = Instance.new("UIPadding")
        resetPad.PaddingTop = UDim.new(0, 8)
        resetPad.PaddingBottom = UDim.new(0, 8)
        resetPad.PaddingLeft = UDim.new(0, 15)
        resetPad.PaddingRight = UDim.new(0, 15)
        resetPad.Parent = resetBtn
        local resetCorner = Instance.new("UICorner")
        resetCorner.CornerRadius = UDim.new(0, 5)
        resetCorner.Parent = resetBtn
        local resetStroke = Instance.new("UIStroke")
        resetStroke.Color = COLORS.BORDER
        resetStroke.Thickness = 1
        resetStroke.Parent = resetBtn
        resetBtn.Parent = buttonRow

        -- Delete button (danger style, with icon)
        local deleteBtn = resetBtn:Clone()
        deleteBtn.Text = "üóëÔ∏è Delete All Data"
        deleteBtn.BackgroundColor3 = COLORS.ACCENT_SECOND  -- danger red
        deleteBtn.TextColor3 = COLORS.BG_MAIN  -- text on danger is background main (dark):contentReference[oaicite:47]{index=47}
        local delStroke = deleteBtn:FindFirstChildOfClass("UIStroke")
        if delStroke then delStroke.Color = COLORS.ACCENT_SECOND end
        deleteBtn.Parent = buttonRow

        -- Base & danger button hover effects
        local function setupButtonHover(btn, isDanger, isPrimary)
            btn.MouseEnter:Connect(function()
                if isPrimary or isDanger then
                    -- Primary and danger use opacity change on hover (simulate opacity 0.9)
                    btn.BackgroundTransparency = 0.1  -- slightly reduce opacity (make color a bit dimmer)
                else
                    -- Base button: change to hover color (#3b4261):contentReference[oaicite:48]{index=48}
                    btn.BackgroundColor3 = Color3.fromRGB(59, 66, 97)
                end
                btn.ResetHover = false
            end)
            btn.MouseLeave:Connect(function()
                if isPrimary or isDanger then
                    btn.BackgroundTransparency = 0  -- return to fully opaque
                else
                    btn.BackgroundColor3 = Color3.fromRGB(41, 46, 66)
                end
            end)
        end
        setupButtonHover(resetBtn, false, false)
        setupButtonHover(deleteBtn, true, false)
        -- (If we had a primary style button here, we'd call setupButtonHover(button, false, true))

        -- Connect button actions (for demonstration, just print to output)
        resetBtn.MouseButton1Click:Connect(function()
            print("Settings reset to default.")
        end)
        deleteBtn.MouseButton1Click:Connect(function()
            print("All data deleted!")
        end)
    end
end

-- Set initial active tab (General)
categoryContentFrames[1].Visible = true
-- Configure initial sidebar active styles
local firstNavButton = sidebar:FindFirstChild("Nav"..categories[1])
if firstNavButton then
    firstNavButton.TextColor3 = COLORS.TEXT_PRIMARY
    firstNavButton.FontFace = fontInterBold
    local hl = firstNavButton:FindFirstChild("Highlight")
    if hl then hl.Visible = true end
    firstNavButton.BackgroundColor3 = COLORS.ACCENT_PRIMARY
    firstNavButton.BackgroundTransparency = 0.85  -- 15% opacity accent (active):contentReference[oaicite:49]{index=49}
end

-- Sidebar navigation button click logic
for idx, catName in ipairs(categories) do
    local navButton = sidebar:FindFirstChild("Nav"..catName)
    if navButton then
        navButton.MouseButton1Click:Connect(function()
            if activeCategoryIndex == idx then return end
            -- Hide old active content and reset its nav button
            categoryContentFrames[activeCategoryIndex].Visible = false
            local oldButton = sidebar:FindFirstChild("Nav"..categories[activeCategoryIndex])
            if oldButton then
                oldButton.TextColor3 = COLORS.TEXT_SECONDARY
                oldButton.FontFace = fontInter
                oldButton.BackgroundTransparency = 1
                local oldHL = oldButton:FindFirstChild("Highlight")
                if oldHL then oldHL.Visible = false end
            end
            -- Show new content and set active styles
            activeCategoryIndex = idx
            categoryContentFrames[idx].Visible = true
            navButton.TextColor3 = COLORS.TEXT_PRIMARY
            navButton.FontFace = fontInterBold
            navButton.BackgroundColor3 = COLORS.ACCENT_PRIMARY
            navButton.BackgroundTransparency = 0.85
            local hl = navButton:FindFirstChild("Highlight")
            if hl then hl.Visible = true end
        end)
    end
end

-- Dropdown (Mode) toggle script (placed after content frames so it overlaps on top)
modeDropdown.MouseButton1Click:Connect(function()
    -- Position the options frame below the dropdown
    local absPos = modeDropdown.AbsolutePosition
    modeOptionsFrame.Position = UDim2.new(0, absPos.X - panel.AbsolutePosition.X,
                                         0, absPos.Y - panel.AbsolutePosition.Y + modeDropdown.AbsoluteSize.Y)
    modeOptionsFrame.ZIndex = 5
    modeDropdown.ZIndex = 5
    for _, btn in ipairs(modeOptionsFrame:GetChildren()) do
        if btn:IsA("TextButton") then btn.ZIndex = 5 end
    end
    modeOptionsFrame.Visible = not modeOptionsFrame.Visible
end)
